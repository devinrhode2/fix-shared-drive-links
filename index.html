<!DOCTYPE html>
<html>
  <head>
    <title>Fix shared drive links</title>
    <meta />
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.4.3/babel.js"></script>
    <style>
      input {
        width: 100%;
      }
      div > input {
        margin-bottom: 16px;
      }
      * {
        font-size: 24px;
        font-family: sans-serif;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      class Main extends React.Component {
        constructor(props) {
          super(props);
          this.state = {
            domain: localStorage.getItem('domain') || 'your.domain.com/folder',
            file_path: 'foo\\bar bar\\baz\\Cool.docx'
          };

          this.updateLink = this.updateLink.bind(this);
          this.updateInput = this.updateInput.bind(this);
        }
        updateInput(e) {
          var newState = this.state;
          newState[e.target.name] = e.target.value;
          this.setState(newState);

          this.updateLink();
        }
        updateLink() {
          let link = this.state.domain;
          if (this.state.domain.includes('://')) {
            alert('your domain has an issue, remove "://" and everything before it.');
          }
          link = 'smb://' + this.state.domain;
          var needsJoiningSlash = true;
          if (link.endsWith('/')) {
            needsJoiningSlash = false;
            console.warn('you may want folder after domain')
          }

          let file_path = this.state.file_path.replace(/ /g, '%20').replace(/\\/g, '/');
          if (file_path.startsWith('/')) {
            file_path = substring(1, file_path.length);
          }
          if (file_path.startsWith('S:\')) {
            file_path.replace('S:\', '/');
          }

          this.setState({link: link + file_path});
          
          localStorage.setItem('domain', this.state.domain);
        }
        componentDidMount() {
          this.updateLink();
        }
        render() {
          return <div>
            <div>Your domain/folder path: <input type="text" id="domain-input" name="domain" onChange={this.updateInput} defaultValue={this.state.domain} /></div>
            <div>Your file path: <input type="text" id="file-path" name="file_path" onChange={this.updateInput} defaultValue={this.state.file_path} /></div>
            <div>Your shareable url: <input type="text" value={this.state.link} /></div>
          </div>
        }
      };
      ReactDOM.render(
        <Main />,
        document.getElementById('root')
      );
    </script>
  </body>
</html
